<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl">
  
  
  
  
  <title>网络层:数据平面 | Thriumph</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="《计算机网络自顶向下方法》第四章读书笔记">
<meta name="keywords" content="计算机网络">
<meta property="og:type" content="article">
<meta property="og:title" content="网络层:数据平面">
<meta property="og:url" content="http://yoursite.com/网络层-数据平面.html">
<meta property="og:site_name" content="Thriumph">
<meta property="og:description" content="《计算机网络自顶向下方法》第四章读书笔记">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-9aad3d44cfa51dc9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-cdf85afcabfc37a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-f53f8cd079369ccb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-62b7cb21d90173b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-2a8a0cbbc40232c8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-2bd0fe86e92759bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-fcf0f872d0aac27a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-9e5622de989174fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-c597d3929ff91878.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-7da285f83b61eeca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/14577467-fa3763867e3c05a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-07-17T04:26:45.504Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="网络层:数据平面">
<meta name="twitter:description" content="《计算机网络自顶向下方法》第四章读书笔记">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/14577467-9aad3d44cfa51dc9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  
    <link rel="alternative" href="/atom.xml" title="Thriumph" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet">
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="/img/avatar.png" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Thriumph</a></h1>
        </hgroup>
        
        <p class="header-subtitle">路漫漫其修远兮，吾将上下而求索</p>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="搜索一下" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="/">博客主页</a></li>
                        
                            <li><a  href="/archives/">所有文章</a></li>
                        
                            <li><a  href="/tags/">标签</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl qq"  target="_blank" href="#" title="qq">qq</a>
                            
                                <a class="fl mail"  target="_blank" href="#" title="mail">mail</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/HOOK技术/" style="font-size: 10px;">HOOK技术</a> <a href="/tags/PE文件/" style="font-size: 11.67px;">PE文件</a> <a href="/tags/c/" style="font-size: 10px;">c</a> <a href="/tags/kali/" style="font-size: 10px;">kali</a> <a href="/tags/pwn/" style="font-size: 20px;">pwn</a> <a href="/tags/pwnable-kr/" style="font-size: 18.33px;">pwnable.kr</a> <a href="/tags/re/" style="font-size: 13.33px;">re</a> <a href="/tags/wp/" style="font-size: 15px;">wp</a> <a href="/tags/加密算法/" style="font-size: 10px;">加密算法</a> <a href="/tags/汇编/" style="font-size: 11.67px;">汇编</a> <a href="/tags/注入技术/" style="font-size: 10px;">注入技术</a> <a href="/tags/脱壳/" style="font-size: 10px;">脱壳</a> <a href="/tags/补丁/" style="font-size: 10px;">补丁</a> <a href="/tags/计算机网络/" style="font-size: 16.67px;">计算机网络</a>
                    </div>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">网安界的小萌新，喜欢逆向，二进制，日常划水，嘻嘻嘻ヾ(≧▽≦*)o</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Thriumph</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/avatar.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Thriumph</a></h1>
            </hgroup>
            
            <p class="header-subtitle">路漫漫其修远兮，吾将上下而求索</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">博客主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="qq" target="_blank" href="#" title="qq">qq</a>
                    
                        <a class="mail" target="_blank" href="#" title="mail">mail</a>
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap"><article id="post-网络层-数据平面" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/网络层-数据平面.html" class="article-date">
      <time datetime="2019-07-09T07:45:09.000Z" itemprop="datePublished">2019-07-09</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      网络层:数据平面
    </h1>
  


      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/读书笔记/">读书笔记</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/计算机网络/">计算机网络</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>《计算机网络自顶向下方法》第四章读书笔记</p>
<a id="more"></a>

<p><img src="https://upload-images.jianshu.io/upload_images/14577467-9aad3d44cfa51dc9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h1 id="网络层概述"><a href="#网络层概述" class="headerlink" title="网络层概述"></a>网络层概述</h1><p>1.每台路由器的<strong><code>数据平面</code></strong> 的主要作用是从其输入链路向其输出链路转发数据报。</p>
<p>2.<strong><code>控制平面</code></strong>的主要作用是协调这些本地的每路由器转发动作，使得数据报沿着源和目的地主机之间的路由器路径最终进行端到端传送。</p>
<p>3.<strong><code>路由器</code></strong>（不运行应用层网络层协议）的主要作用是将数据从入链路转发到出链路。</p>
<p>4.<strong><code>A,B两主机通信：</code></strong> A中网络层取得于A运输层的报文段，每个报文段封装成数据报，向相邻路由器发送。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14577467-cdf85afcabfc37a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="转发和路由选择（数据平面和控制平面）"><a href="#转发和路由选择（数据平面和控制平面）" class="headerlink" title="转发和路由选择（数据平面和控制平面）"></a>转发和路由选择（数据平面和控制平面）</h2><p><strong><code>网络层作用：</code></strong> 将分组从一台发送主机发送到另一台接受主机。IP协议：编址规则，数据报格式，分组处理规则。</p>
<p><strong><code>需要两种功能：转发和路由选择</code></strong></p>
<ul>
<li><p><strong><code>转发：</code></strong> 分组从（路由器）输入链路接口转移到适当输出链路接口的路由器本地动作</p>
</li>
<li><p><strong><code>路由选择：</code></strong> 分组从发送方发往接收方时，网络层须决定分组采用的路由或路径    </p>
</li>
</ul>
<p><strong><code>转发是路由器本地动作，路由选择是网络范围过程。</code></strong> 比如开车从北京到上海，转发相当于在某个路口选择某一条岔路，路由选择相当于规划从北京到上海所有线路的过程</p>
<p><strong><code>路由选择算法：</code></strong> 计算采用的路径的算法，决定了插入路由器的转发表中的值</p>
<p>每台路由都有一张 <strong><code>转发表</code></strong>。路由器检查分组首部字段值（可能是目的地址或所属连接，看网络层协议）来转发分组，使用该值在转发表索引查询。该值指出了该分组将被转发的路由器输出链路接口  </p>
<h3 id="控制平面：传统的方法"><a href="#控制平面：传统的方法" class="headerlink" title="控制平面：传统的方法"></a>控制平面：传统的方法</h3><p><strong><code>路由选择算法决定了插入路由器转发表中的值(两种算法)</code></strong></p>
<ul>
<li>集中式</li>
<li>分布式</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/14577467-f53f8cd079369ccb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h3 id="控制平面：SDN方法"><a href="#控制平面：SDN方法" class="headerlink" title="控制平面：SDN方法"></a>控制平面：SDN方法</h3><p>远程控制器计算和分发转发表以供每台路由器使用</p>
<p>控制平面路由 <strong><code>选择功能</code></strong> 和 <strong><code>物理路由器</code></strong> 是分开的，<strong><code>选择设备执行转发，远程控制器计算并分发转发表</code></strong> ，这种控制平面方法是 <strong><code>软件定义网络（Soft-ware-Defined Networking,SDN）</code></strong> 的本质</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14577467-62b7cb21d90173b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt>                                                 </p>
<h2 id="网络服务模型"><a href="#网络服务模型" class="headerlink" title="网络服务模型"></a>网络服务模型</h2><p><strong><code>网络服务模型：</code></strong> 定义了分组在发送与接收端系统之间的端到端运输特性</p>
<p><strong><code>网络层提供的服务（IP没有的服务）：</code></strong></p>
<p>运输层向网络层传递分组时：</p>
<p><strong><code>①确保交付：</code></strong> 确保分组最终达到目的地</p>
<p><strong><code>②具有时延上界的确保交付：</code></strong> 确保分组交付和主机到主机时延上界内交付<br>为给定源和目的地之间的分组流提供服务时<br>：<br><strong><code>③有序分组交付</code></strong></p>
<p><strong><code>④确保最小带宽：</code></strong> 模仿发送方和接收方之间一条特定比特率传输链路的行为。发送速率低于该速率，分组不会丢失，且会在预定时延内到达</p>
<p><strong><code>⑤ 安全性：</code></strong> 使用仅由源和目的地主机知晓的密钥，加密数据报，源加密，目的主机解密。此外还有数据完整性和源鉴别服务   </p>
<p>因特网的网络层IP协议提供单一服务，尽力而为服务，无带宽保证，无丢包保证，无顺序保证，不定时，无拥塞指示</p>
<p><strong><code>分组交换机</code></strong> 是指一台通用分组交换设备，它根据分组首部字段中的值，从输入链路接口到输出链路接口转移分组。某些分组交换机称为 <strong><code>链路层交换机</code></strong> ，基于链路层帧中的字段值做出转发决定，这些交换机因此被称为链路层设备。其他分组交换机称为 <strong><code>路由器</code></strong> ，基于网络层数据报中的首部字段值做出转发决定。路由器因此是网络层设备</p>
<p><strong><code>路由器是网络层设备</code></strong></p>
<h1 id="路由器工作原理"><a href="#路由器工作原理" class="headerlink" title="路由器工作原理"></a>路由器工作原理</h1><p><strong><code>路由器有4个主要组件：</code></strong></p>
<p><strong><code>①输入端口：</code></strong> 路由器中执行终结入物理链路的物理层功能。与位于入链路远端的数据链路层交互来执行数据链路层功能。执行查找功能。通过查询转发表决定路由器的输出端口，到达的分组通过路由器的交换结构转发到输出端口。控制分组从输入端口转发到路由选择处理器。</p>
<p><strong><code>②交换结构：</code></strong> 交换结构将路由器的输入端口连接到它的输出端口。这种交换结构完全包含在路由器之中</p>
<p><strong><code>③输出端口：</code></strong> 输出端口存储从交换结构接收的分组，并通过执行必要的链路层和物理层功能在输出链路上传输这些分组。 </p>
<p><strong><code>④路由选择处理器：</code></strong> 路由选择处理器执行控制平面功能。它执行路由选择协议，维护路由选择表与关联链路状态信息，并为该路由器计算转发表。在软件定义网络（Software-Defined Networking, SDN）路由器中，路由选择处理器负责与远程控制器通信，目的是接收由远程控制器计算的转发表项，并在该路由器的输入端口安装这些表项。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14577467-2a8a0cbbc40232c8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="输入端口处理和基于目的地的转发"><a href="#输入端口处理和基于目的地的转发" class="headerlink" title="输入端口处理和基于目的地的转发"></a>输入端口处理和基于目的地的转发</h2><p>路由器用分组目的地址的前缀与转发表中的表项进行匹配。如果存在一个匹配项，则路由器向与该匹配项相关联的链路转发该分组。当有多个匹配时，该路由器使用 <strong><code>最长前缀匹配规则</code></strong> ，即在表中寻找最长的匹配项，并向与最长前缀匹配相关项的链路接口转发分组。</p>
<h3 id="输入端口"><a href="#输入端口" class="headerlink" title="输入端口"></a>输入端口</h3><p>①线路端接</p>
<p>②数据链路处理（协议、拆封）</p>
<p>③查找</p>
<ul>
<li><p>查找必须在纳秒级别执行，不仅要用硬件执行查找，而且要对大型转发表使用快速查找算法，而且需要更快的内存访问速度（DRAM、SRAM）。</p>
</li>
<li><p>三态内容可寻址存储器TCAM常被用于查找。使用TCAM，一个32bit的IP地址放入内存，TCAM在基本常数时间内返回转发表项内容</p>
</li>
</ul>
<p>④转发</p>
<ul>
<li><p>转发表由路由选择处理器计算和更新，从路由选择处理器经过独立总线复制到（输入）线路卡</p>
</li>
<li><p>有了转发表副本，转发决策能在每个输入端口本地做出，无须调动路由选择处理器，避免集中式处理</p>
</li>
</ul>
<p>⑤排队</p>
<ul>
<li>查找确定了某分组输出端口，分组就能发送进入交换结构。一个被阻塞的分组必须在输入端口处排队</li>
</ul>
<h3 id="查找采取的动作"><a href="#查找采取的动作" class="headerlink" title="查找采取的动作"></a>查找采取的动作</h3><p>①物理层和链路层的处理</p>
<p>②检查分组的版本号，检验以及寿命字段，并重写后两个字段</p>
<p>③更新用于网络管理的计数器</p>
<h2 id="交换"><a href="#交换" class="headerlink" title="交换"></a>交换</h2><p>交换结构位于路由器的核心部位。</p>
<h3 id="交换的三种方式"><a href="#交换的三种方式" class="headerlink" title="交换的三种方式"></a>交换的三种方式</h3><p><strong><code>①经内存交换</code></strong></p>
<ul>
<li>一个分组到达输入端口时，该端口会先通过中断方式向路由选择处理器发出信号</li>
<li>分组从输入端口复制到处理器内存中（现代路由器查找交换进内存，是由输入线路卡处理的）</li>
<li>早期路由选择处理器从首部提取目的地址，在转发表查找输出端口，将分组复制到输出端口</li>
</ul>
<p><strong><code>②经总线交换</code></strong> </p>
<ul>
<li>输入端口经一根共享总线将分组直接传送到输出端口，无需路由选择处理器的干预</li>
<li>路由器的交换带宽受总线速率限制</li>
</ul>
<p><strong><code>③经互联网络交换</code></strong></p>
<ul>
<li>纵横式交换机，2N条总线组成网络，连接N各输入端口和N个输出端口<br>每条垂直的总线与每条水平的总线交叉，交叉点通过交换结构控制器开启闭合</li>
<li>某分组到达端口A，需要转发到Y，交换机控制器闭合总线A和Y的交叉点，A在其总线上发送分组，仅由Y接收；同时B也能发分组到X，因为没有公用总线。纵横式网络能并行转发多个分组</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/14577467-2bd0fe86e92759bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="输出端口处理"><a href="#输出端口处理" class="headerlink" title="输出端口处理"></a>输出端口处理</h2><p>①排队（缓存管理）</p>
<p>②数据链路处理（协议、拆封）</p>
<p>③线路端接</p>
<p><img src="https://upload-images.jianshu.io/upload_images/14577467-fcf0f872d0aac27a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h2 id="排队"><a href="#排队" class="headerlink" title="排队"></a>排队</h2><p>输入、输出端口都能形成分组队列，取决于流量负载、交换结构<br>随着队列增长，路由器缓存空间会耗尽，出现丢包</p>
<p>需要路由器缓存吸收流量负载波动，需要多少缓存？</p>
<ul>
<li>少量TCP流：RTT * C（链路容量）</li>
<li>大量TCP流：RTT* C/ (N^1/2)</li>
</ul>
<p>输出端口排队，需要分组调度程序选出一个分组发送。提供服务质量保证</p>
<p>主动队列管理： </p>
<ul>
<li>缓存填满前丢弃（或首部加个标记）一个分组，向发送方提供一个拥塞信号</li>
<li>随机早期检测算法：平均队列长度在某个范围内时，以某种概率被丢弃/标记</li>
</ul>
<h2 id="分组调度"><a href="#分组调度" class="headerlink" title="分组调度"></a>分组调度</h2><p><strong><code>先进先出（First-In-First-Out, FIFO）:</code></strong><br>链路调度规则按照到达输出链路队列的相同次序来选择分组在链路上传输。</p>
<p><strong><code>优先权排队：</code></strong> 到达输出链路的分组被分类放入输出队列中的优先权类。在非抢占式优先权排队规则下，一旦分组开始传输，就不能打断。</p>
<p><strong><code>循环排队：</code></strong> 分组像使用优先权排队那样被分类。然而，在类之间不存在严格的服务优先权，循环调度器在这些类之间轮流提供服务。保持工作排队规则在有分组排队等待传输时，不允许链路保持空闲。加权公平排队（Weighted Fair Queuing, WFQ）规则下，每个类在任何时间间隔内可能受到不同数量的服务。具体而言，每个类i被分配一个权wi。使用WFQ方式，在类i有分组要发送的任何时间间隔中，第i类将确保接受到的服务部分等于wi/(∑wj)，分母中的和是计算所有分组排队等待传输的类别得到的。对于一条传输速率为R的链路，第i类总能获得至少为R ∙ wi/(∑wj)的吞吐量。</p>
<h1 id="网络协议"><a href="#网络协议" class="headerlink" title="网络协议"></a>网络协议</h1><p><strong><code>网络层三个组件 ：</code></strong></p>
<ul>
<li><strong><code>IP协议</code></strong></li>
<li><strong><code>路由选择协议</code></strong></li>
<li><strong><code>控制报文协议（ICMP）</code></strong> ：报告数据报中的差错、对某些网络层信息请求进行响应的设施</li>
</ul>
<h2 id="IPv4数据报格式"><a href="#IPv4数据报格式" class="headerlink" title="IPv4数据报格式"></a>IPv4数据报格式</h2><p>网络层分组被称为<code>数据报</code></p>
<p><img src="https://upload-images.jianshu.io/upload_images/14577467-9e5622de989174fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p><strong><code>版本号（IPv4、IPv6）：</code></strong> 不同版本对数据报不同解释，4比特规定了数据报的IP协议版本</p>
<p><strong><code>首部长度：</code></strong> 数据报可包含可变数量的选项。不过大部分没有，首部固定20字节</p>
<p><strong><code>服务类型：</code></strong> 区分不同类型的IP数据报</p>
<p><strong><code>数据报长度：</code></strong> 首部+数据的长度。该字段16bit，然而一般数据报很少超过1500字节</p>
<p><strong><code>标识、标志、片偏移:</code></strong> IP分片相关。不过IPv6不允许在路由器上对分组分片</p>
<p><strong><code>寿命TTL：</code></strong> 确保数据报不会永远在网络中循环。每被一个路由器处理时，值-1。若值减到0，丢弃数据报</p>
<p><strong><code>协议号：</code></strong> 到达最终目的地才有用，指示了IP数据报的数据部分应该交给哪个运输层协议。如6交给TCP，如17交给UDP</p>
<p>协议号是将网络层与运输层绑定到一起的粘合剂；端口号是将运输层和应用层绑定的粘合剂</p>
<p><strong><code>首部检验和：</code></strong> 帮忙路由器检测收到IP数据报中首部的比特错误，有错一般丢弃</p>
<p><strong><code>源和目的IP地址：</code></strong> 源主机通过DNS查找目的地址</p>
<p>选项：IPv6已抛弃选项字段</p>
<p><strong><code>数据（有效载荷）：</code></strong> 包含运输层报文段（TCP或UDP），或ICMP报文段</p>
<ul>
<li>一个IP数据报有长为20的首部，如果数据报承载一个TCP报文段，则每个无分片数据报承载总长40的首部（还有TCP的20）以及应用层报文</li>
</ul>
<h2 id="IPv4数据报分片"><a href="#IPv4数据报分片" class="headerlink" title="IPv4数据报分片"></a>IPv4数据报分片</h2><ul>
<li>并不是所有链路层协议都能承载相同长度的网络层分组，如以太网帧能承载不超过1500字节的数据，某些广域网链路帧不超过576字节</li>
<li>一个链路层帧承载的最大数据量：最大传送单元MTU</li>
<li>限制了IP数据报的长度，且发送方与目的路径上的每段链路可能使用不同的链路层协议，有不同的MTU</li>
<li>将IP数据报中的数据分片成多个较小的IP数据报，用单独的链路层帧封装这些小IP数据报，每个小数据报叫片</li>
<li>数据报的重新组装放在端系统中，而不是路由器中</li>
<li>标识、标志、片偏移字段，帮助主机执行重组任务 </li>
<li>一个4000字节的数据报（20+3980）到达一台路由器，转发到一条MTU为1500子节的链路上。必须分配3个独立的片，假设初始数据报的标识号是777，则前两片字节都为20+1480，第三层为20+1020</li>
</ul>
<p><strong>安全性</strong></p>
<ul>
<li>分片被用于Dos攻击，如Jolt2，攻击者向目标主机发送小片的流，没有一个片的偏移量是0，目标试图重组时可能会崩溃</li>
<li>发送交迭偏移量的IP片，不能被适当排列，可能会崩溃</li>
<li>IPv6废除了分片，简化了IP分组的处理</li>
</ul>
<h2 id="IPv4编址"><a href="#IPv4编址" class="headerlink" title="IPv4编址"></a>IPv4编址</h2><p><strong>主机与路由器连入网络的方法</strong></p>
<p>①一台主机通常只有一条链路连接到网络，主机IP发送数据报从该链路发送</p>
<p>②主机与物理链路的边界叫接口，一台路由器有多个接口</p>
<p>③IP要求每台主机和路由器都有自己的IP地址，因此一个IP地址实际上是与每一个接口相关联的</p>
<p>每个IP地址长度32bit（4字节），总共2^32个可能的IP地址，约40亿个,用<strong><code>点分十进制记法</code></strong> ，如193.32.216.9</p>
<p><strong><code>一个接口的IP地址的一部分需要由其连接的子网决定</code></strong></p>
<ul>
<li>如互联3个主机接口与1个路由器接口的网络形成一个子网，IP编址为这个子网分配一个地址：223.1.1.0/24，/24记法称为子网掩码，指示了32bit中的最左侧24bit定义了子网地址</li>
<li>为了确定子网，分开主机和路由器的每个接口，产生几个隔离的网络岛，使用接口端接这些隔离的网络的端点，这些隔离的网络中每一个都叫做一个子网</li>
</ul>
<p><strong><code>因特网地址分配策略：</code></strong> 无类别域间路由选择CDIR</p>
<p>a.b.c.d/x的地址的x最高比特构成IP地址的网络部分，称为该地址的前缀，一个组织通常被分配一块连续的地址，即具有相同前缀的一段地址。BGP路由选择协议中，该组织网络外的路由器仅考虑x，减少了转发表的长度，因为形式为a.b.c.d/x单一表项足以将数据报转发到该组织内的任何目的地</p>
<p><strong><code>地址聚合（路由聚合）：</code></strong> 使用单个网络前缀通告多个网络的能力<br>一个ISP将8个组织连接到因特网。该ISP向外界通告：向我发送以200.23.16.0/20开始的任何内容。外部无需知道在该地址块内还有8个其他组织，每个组织有自己的子网</p>
<p>一个地址的剩余32-x比特可认为是用于区分该组织内部设备的。组织内部路由器转发分组时，才会考虑这些比特</p>
<p>在CDIR出现之前，采用分类编址，A、B、C类网络，分别具有8、16、24比特子网地址</p>
<p><strong><code>C类（/24）</code></strong> 仅能容纳2^8-2=254台主机（其中两个用于特殊用途）。 C类地址第1字节、第2字节和第3个字节为网络地址，第4个字节为主机地址。另外第1个字节的前三位固定为110。192.168.X.X是私有地址。</p>
<p>(192.168.0.0-192.168.255.255)</p>
<p>⑵ C类地址范围：192.0.0.0—223.255.255.255。</p>
<p><strong><code>B类（/16）</code></strong> 支持65534台主机，一个组织分配一个B类地址却只用2000个接口，造成巨大浪费。B类地址范围：128.0.0.0—191.255.255.255</p>
<p><strong><code>A类：</code></strong>  A类地址第1字节为网络地址，其它3个字节为主机地址。，A类地址范围：1.0.0.0—127.255.255.255。A类地址中的私有地址和保留地址：</p>
<p>① 10.X.X.X是私有地址（所谓的私有地址就是在互联网上不使用，而被用在局域网络中的地址）。范围（10.0.0.0.0-10.255.255.255）</p>
<p>② 127.X.X.X是保留地址，用做循环测试用的</p>
<p><strong><code>IP广播地址</code></strong></p>
<p>当一台主机发出目的地址为255.255.255.255的数据报时，报文会交付给同一个网络的所有主机，可用于DHCP发现报文的发送，广播最小生成树</p>
<h3 id="获取一块地址"><a href="#获取一块地址" class="headerlink" title="获取一块地址"></a>获取一块地址</h3><ul>
<li>子网获取IP地址：由ISP从它大块地址中分配</li>
<li>ISP获取IP地址：IP地址由因特网名字和编号分配机构ICANN管理（也管理DNS根服务器、AS标识号）。ICANN向区域性因特网注册机构分配地址，处理本地域内的地址分配/管理</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/14577467-c597d3929ff91878.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<h3 id="获取主机地址"><a href="#获取主机地址" class="headerlink" title="获取主机地址"></a>获取主机地址</h3><ul>
<li>组织获得一块地址，就可为组织内的主机、路由器接口逐个分配IP地址</li>
<li>主机地址能手动配置，也能自动配置，即动态主机配置协议DHCP</li>
</ul>
<h3 id="动态主机配置协议DHCP"><a href="#动态主机配置协议DHCP" class="headerlink" title="动态主机配置协议DHCP"></a>动态主机配置协议DHCP</h3><ul>
<li><p>DHCP允许主机自动获取一个IP地址</p>
</li>
<li><p>DHCP可配置，可以使主机每次连网获得相同IP地址，也可每次分配一个临时IP地址（比如ISP给你家分配了一个IP地址，你想多台主机同时连网时，需要配置路由器。一般电信这种会给你家分配临时IP地址，这样节省IP地址。也有的每次连接都是固定地址比如公寓的ISP，这时需要手动在路由器设置里输入，可以ipconfig查看）</p>
</li>
<li><p>DHCP还允许主机查看子网掩码、默认网关（第一跳路由器地址）、本地DNS服务器地址</p>
</li>
<li><p>DHCP能将主机连接进一个网络的自动能力，常被称为即插即用协议</p>
</li>
<li><p>DHCP是一个客户-服务器协议。新来的主机要获得自使用的IP地址等网络配置信息</p>
</li>
</ul>
<p>1.每个子网都有一台DHCP服务器</p>
<p>2.若子网没有DHCP服务器，则由一个路由器做DHCP中继代理，该代理知道该网络的DHCP服务器地址</p>
<h4 id="DHCP协议的四个步骤"><a href="#DHCP协议的四个步骤" class="headerlink" title="DHCP协议的四个步骤"></a>DHCP协议的四个步骤</h4><p><strong><code>DHCP服务器发现</code></strong></p>
<p>新到的客户通过广播DHCP发现报文，发现一个要与其交互的DHCP服务器<br>客户在UDP分组中向端口67发送该发现报文，此时必须用广播地址255.255.255.255，源地址是0.0.0.0</p>
<p><strong><code>DHCP服务器提供</code></strong></p>
<p>DHCP收到DHCP发现报文后，响应一个DHCP提供报文，仍然使用广播地址，因为此时新客户并没有IP地址</p>
<p>可能有多台DHCP服务器，每台服务器提供的报文中，有向客户主机推荐的IP地址、网络掩码以及IP地址租用期（一般几天或几小时）</p>
<p><strong><code>DHCP请求</code></strong></p>
<p>客户从提供中选一个，向选中的服务器提供一个DHCP请求报文进行响应，回显配置参数</p>
<p><strong><code>DHCP ACK</code></strong></p>
<p>收到DHCP请求报文后，用DHCP ACK报文对其记性响应，证实所传参数<br>客户收到ACK后，交互完成，在租期内使用DHCP分配的IP地址。DHCP提供了机制允许客户更新对一个IP地址的租用</p>
<h2 id="网络地址转换"><a href="#网络地址转换" class="headerlink" title="网络地址转换"></a>网络地址转换</h2><p><img src="https://upload-images.jianshu.io/upload_images/14577467-7da285f83b61eeca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>当ISP已经为SOHO网络当前地址范围分配过一块连续地址，而SOHO内主机越来也多时，需要用到NAT（比如电信给你家分配一个动态IP地址，家里要好几台手机电脑联网用一个IP地址，需要用NAT）</p>
<p> 当ISP已经为SOHO网络当前地址范围分配过一块连续地址，而SOHO内主机越来也多时，需要用到NAT（比如电信给你家分配一个动态IP地址，家里要好几台手机电脑联网用一个IP地址，需要用NAT）</p>
<h3 id="UPnP"><a href="#UPnP" class="headerlink" title="UPnP"></a>UPnP</h3><ul>
<li>NAT穿越由通用即插即用（UPnP）提供</li>
<li>UPnP是一种允许主机发现并配置邻接NAT的协议，要求主机和NAT都是UPnP兼容</li>
<li>使用UPnP，在主机上运行的应用程序能为某些请求的公共端口号请求一个NAT映射（专用IP地址，专用端口号 — 公共IP地址，公共端口号）。如果某NAT接收请求并生成映射，来自外部的结点能发起到（公共IP地址，公共端口号）的TCP连接</li>
</ul>
<h2 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h2><p>IPv4地址耗尽，IPv6也可强化IPv4某些方面</p>
<h3 id="IPv6数据报格式"><a href="#IPv6数据报格式" class="headerlink" title="IPv6数据报格式"></a>IPv6数据报格式</h3><p><img src="https://upload-images.jianshu.io/upload_images/14577467-fa3763867e3c05a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>①扩大的地址容量 </p>
<p>32bit —&gt; 128bit</p>
<p>r除了单播多播地址，引入任播地址，使数据报交付给一组主机中的任意一个</p>
<p>②简化高效的40字节首部</p>
<p>③流标签与优先级 </p>
<p>如音频流、视频流、高优先级用户承载的流量</p>
<p><strong><code>IPv6定义的字段：</code></strong></p>
<p>①版本</p>
<p>②流量类型</p>
<p>③流标签</p>
<p>④有效载荷长度</p>
<p>⑤下一个首部</p>
<p>⑥跳限制</p>
<p>⑦源地址和目的地址</p>
<p>⑧数据</p>
<p><strong><code>IPv6中不存在的IPv4数据报字段</code></strong></p>
<p>①分片/重新组装：只能在源与目的地进行</p>
<p>②首部检验和</p>
<p>③选项：放到了下一个首部位置，使得IP首部定长40字节</p>
<h3 id="IPv4到IPv6的迁移"><a href="#IPv4到IPv6的迁移" class="headerlink" title="IPv4到IPv6的迁移"></a>IPv4到IPv6的迁移</h3><p>4到v6的迁移，两种双栈（dual-stack）方法。</p>
<p>1.接受结点和发送节点如果都是IPv6，则使用v6，否则使用IPv4。</p>
<p>2.将IPv4路由器集合作为隧道（tunneling），将IPv6数据报放入IPv4的数<br>据字段</p>
<h1 id="通用转发和SDN"><a href="#通用转发和SDN" class="headerlink" title="通用转发和SDN"></a>通用转发和SDN</h1><p>将基于目的地转发的特征总结为两个步骤：查找目的IP地址（“匹配”），然后将分组发送到有特定输出端口的交换结构（“动作”）。现有一种更有意义的通用“匹配加动作”范式，其中能够对协议栈的多个首部字段进行“匹配”，这些首部字段是与不同层次的不同协议相关联的。</p>
<h2 id="匹配"><a href="#匹配" class="headerlink" title="匹配"></a>匹配</h2><p>匹配加动作转发表在OpenFlow中成为流表，它的每个表项包括：</p>
<p>1.首部字段值的集合。入分组将与之匹配。匹配不上流表项的分组将被丢弃或发送到远程控制器做更多处理。</p>
<p>2.计数器集合。这些计数器可以包括已经与该表项匹配的分组数量，以及自从该表项匹配的分组数量，以及自从该表项上次更新以来的时间。</p>
<p>当分组匹配流表项时所采取的动作集合。这些动作可能将分组转发到给定的3.输出端口，丢弃该分组、复制该分组和将它们发送到多个输出端口，和/或重写所选的首部字段。</p>
<h2 id="动作"><a href="#动作" class="headerlink" title="动作"></a>动作</h2><p>1.转发</p>
<p>2.丢弃。没有动作的流表项表明某个匹配的分组应当丢弃</p>
<p>3.修改字段</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a  href="/网络层-数据平面.html">网络层:数据平面</a></p>
        <p><span>文章作者:</span><a  href="/" title="访问 Thriumph 的个人博客">Thriumph</a></p>
        <p><span>发布时间:</span>2019年07月09日 - 15时45分</p>
        <p><span>最后更新:</span>2019年07月17日 - 12时26分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/网络层-数据平面.html" title="网络层:数据平面">http://yoursite.com/网络层-数据平面.html</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/网络层-数据平面.html　　作者: Thriumph" title=""></span>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a  href="/【Pwnable-kr】cmd1.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          【Pwnable.kr】cmd1
        
      </div>
    </a>
  
  
    <a  href="/【Pwnable-kr】lotto.html" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">【Pwnable.kr】lotto</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>


  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#网络层概述"><span class="toc-number">1.</span> <span class="toc-text">网络层概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#转发和路由选择（数据平面和控制平面）"><span class="toc-number">1.1.</span> <span class="toc-text">转发和路由选择（数据平面和控制平面）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#控制平面：传统的方法"><span class="toc-number">1.1.1.</span> <span class="toc-text">控制平面：传统的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#控制平面：SDN方法"><span class="toc-number">1.1.2.</span> <span class="toc-text">控制平面：SDN方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网络服务模型"><span class="toc-number">1.2.</span> <span class="toc-text">网络服务模型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#路由器工作原理"><span class="toc-number">2.</span> <span class="toc-text">路由器工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#输入端口处理和基于目的地的转发"><span class="toc-number">2.1.</span> <span class="toc-text">输入端口处理和基于目的地的转发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#输入端口"><span class="toc-number">2.1.1.</span> <span class="toc-text">输入端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查找采取的动作"><span class="toc-number">2.1.2.</span> <span class="toc-text">查找采取的动作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#交换"><span class="toc-number">2.2.</span> <span class="toc-text">交换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#交换的三种方式"><span class="toc-number">2.2.1.</span> <span class="toc-text">交换的三种方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#输出端口处理"><span class="toc-number">2.3.</span> <span class="toc-text">输出端口处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#排队"><span class="toc-number">2.4.</span> <span class="toc-text">排队</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分组调度"><span class="toc-number">2.5.</span> <span class="toc-text">分组调度</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#网络协议"><span class="toc-number">3.</span> <span class="toc-text">网络协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv4数据报格式"><span class="toc-number">3.1.</span> <span class="toc-text">IPv4数据报格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv4数据报分片"><span class="toc-number">3.2.</span> <span class="toc-text">IPv4数据报分片</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv4编址"><span class="toc-number">3.3.</span> <span class="toc-text">IPv4编址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#获取一块地址"><span class="toc-number">3.3.1.</span> <span class="toc-text">获取一块地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取主机地址"><span class="toc-number">3.3.2.</span> <span class="toc-text">获取主机地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动态主机配置协议DHCP"><span class="toc-number">3.3.3.</span> <span class="toc-text">动态主机配置协议DHCP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DHCP协议的四个步骤"><span class="toc-number">3.3.3.1.</span> <span class="toc-text">DHCP协议的四个步骤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网络地址转换"><span class="toc-number">3.4.</span> <span class="toc-text">网络地址转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UPnP"><span class="toc-number">3.4.1.</span> <span class="toc-text">UPnP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv6"><span class="toc-number">3.5.</span> <span class="toc-text">IPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IPv6数据报格式"><span class="toc-number">3.5.1.</span> <span class="toc-text">IPv6数据报格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPv4到IPv6的迁移"><span class="toc-number">3.5.2.</span> <span class="toc-text">IPv4到IPv6的迁移</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#通用转发和SDN"><span class="toc-number">4.</span> <span class="toc-text">通用转发和SDN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#匹配"><span class="toc-number">4.1.</span> <span class="toc-text">匹配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#动作"><span class="toc-number">4.2.</span> <span class="toc-text">动作</span></a></li></ol></li></ol>
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";
    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>




<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <section class="changyan" id="comments">
  <!--<div id="uyan_frame"></div>-->
  <div id="SOHUCS"></div>
  <script charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/changyan.js"></script>
  <script type="text/javascript">
    window.changyan.api.config({
      appid: 'xxxx',
      conf: 'xxxxxxxxx'
    });
  </script>
</section>
    



    <div class="scroll" id="post-nav-button">
        
            <a  href="/【Pwnable-kr】cmd1.html" title="上一篇: 【Pwnable.kr】cmd1">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a  href="/【Pwnable-kr】lotto.html" title="下一篇: 【Pwnable.kr】lotto">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/格式化字符串漏洞.html">格式化字符串漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/一个有趣的a+b.html">一个有趣的a+b</a></li><li class="post-list-item"><a class="post-list-link" href="/多媒体网络.html">多媒体网络</a></li><li class="post-list-item"><a class="post-list-link" href="/计算机网络中的安全.html">计算机网络中的安全</a></li><li class="post-list-item"><a class="post-list-link" href="/无线网络和移动网络.html">无线网络和移动网络</a></li><li class="post-list-item"><a class="post-list-link" href="/链路层和局域网.html">链路层和局域网</a></li><li class="post-list-item"><a class="post-list-link" href="/网络层-控制平面.html">网络层:控制平面</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】cmd1.html">【Pwnable.kr】cmd1</a></li><li class="post-list-item"><a class="post-list-link" href="/网络层-数据平面.html">网络层:数据平面</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】lotto.html">【Pwnable.kr】lotto</a></li><li class="post-list-item"><a class="post-list-link" href="/运输层.html">运输层</a></li><li class="post-list-item"><a class="post-list-link" href="/应用层.html">应用层</a></li><li class="post-list-item"><a class="post-list-link" href="/计算机网络和因特网.html">计算机网络和因特网</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】blackjack.html">【Pwnable.kr】blackjack</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】coin1.html">【Pwnable.kr】coin1</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】shellcode.html">【Pwnable.kr】shellcode</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】mistake.html">【Pwnable.kr】mistake</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】leg.html">【Pwnable.kr】leg</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】input.html">【Pwnable.kr】input</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】random.html">【Pwnable.kr】random</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】passcode.html">【Pwnable.kr】passcode</a></li><li class="post-list-item"><a class="post-list-link" href="/选择.html">选择</a></li><li class="post-list-item"><a class="post-list-link" href="/十大排序.html">十大排序</a></li><li class="post-list-item"><a class="post-list-link" href="/RC4.html">RC4</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】collision.html">【Pwnable.kr】collision</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】flag.html">【Pwnable.kr】flag</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】bof.html">【Pwnable.kr】bof</a></li><li class="post-list-item"><a class="post-list-link" href="/【Pwnable-kr】fd.html">【Pwnable.kr】fd</a></li><li class="post-list-item"><a class="post-list-link" href="/哈夫曼树.html">哈夫曼树</a></li><li class="post-list-item"><a class="post-list-link" href="/数据结构课程设计.html">数据结构课程设计</a></li><li class="post-list-item"><a class="post-list-link" href="/ISCC2019线上.html">ISCC2019线上</a></li><li class="post-list-item"><a class="post-list-link" href="/DFS递归形式和非递归形式.html">DFS递归形式和非递归形式</a></li><li class="post-list-item"><a class="post-list-link" href="/链表.html">链表</a></li><li class="post-list-item"><a class="post-list-link" href="/掘安杯.html">掘安杯</a></li><li class="post-list-item"><a class="post-list-link" href="/gadget-libc-csu-init.html">gadget_libc_csu_init</a></li><li class="post-list-item"><a class="post-list-link" href="/嘉韦思杯.html">嘉韦思杯</a></li><li class="post-list-item"><a class="post-list-link" href="/linux下基本缓冲区溢出shellcode编写.html">linux下基本缓冲区溢出shellcode编写</a></li><li class="post-list-item"><a class="post-list-link" href="/基本ROP.html">基本ROP</a></li><li class="post-list-item"><a class="post-list-link" href="/栈溢出的保护机制和利用方法.html">栈溢出的保护机制和利用方法</a></li><li class="post-list-item"><a class="post-list-link" href="/gdb常用命令.html">gdb常用命令</a></li><li class="post-list-item"><a class="post-list-link" href="/pwn-环境配置.html">pwn 环境配置</a></li><li class="post-list-item"><a class="post-list-link" href="/kali更新源.html">kali更新源</a></li><li class="post-list-item"><a class="post-list-link" href="/rc3ctf-logmein.html">rc3ctf--logmein</a></li><li class="post-list-item"><a class="post-list-link" href="/ctf编码加解密总结.html">ctf编码加解密总结</a></li><li class="post-list-item"><a class="post-list-link" href="/DLL注入.html">DLL注入</a></li><li class="post-list-item"><a class="post-list-link" href="/windows消息钩取.html">windows消息钩取</a></li><li class="post-list-item"><a class="post-list-link" href="/BugKu逆向.html">BugKu逆向</a></li><li class="post-list-item"><a class="post-list-link" href="/内嵌补丁.html">内嵌补丁</a></li><li class="post-list-item"><a class="post-list-link" href="/ESP脱壳定律.html">ESP定律脱壳</a></li><li class="post-list-item"><a class="post-list-link" href="/IAT导入地址表-EAT机制.html">IAT导入地址表/EAT机制</a></li><li class="post-list-item"><a class="post-list-link" href="/VA-RVA-RAW.html">VA RVA RAW</a></li><li class="post-list-item"><a class="post-list-link" href="/PE文件格式.html">PE文件格式</a></li><li class="post-list-item"><a class="post-list-link" href="/寄存器.html">寄存器</a></li><li class="post-list-item"><a class="post-list-link" href="/栈帧.html">栈帧</a></li><li class="post-list-item"><a class="post-list-link" href="/南邮逆向.html">南邮逆向</a></li><li class="post-list-item"><a class="post-list-link" href="/ctf-play-a-game.html">ctf play a game</a></li><li class="post-list-item"><a class="post-list-link" href="/关于二进制.html">关于二进制</a></li></ul>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

    <script>
        $(".post-list").addClass("toc-article");
        // $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#toc, .switch-btn, .switch-area").toggle();
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
                $(".switch-btn, .switch-area").fadeToggle(300);
            }
        })
    </script>




    <script>
        
    </script>

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2019 Thriumph
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo &nbsp;&nbsp;</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 4;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>